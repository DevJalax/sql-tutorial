select
CASE WHEN (TX.TXN_TYPE='REVERSAL') THEN TX.ORG_TXN_ID ELSE TX.TXN_ID END TXN_ID,
TX.MSG_ID MSG_ID,
TX.CUST_REF_ID RRN,
CASE WHEN (TX.TXN_TYPE = 'REVERSAL' AND TX.ORG_TXN_TYPE='DEBIT') THEN 'DEBITREVERSAL' WHEN (TX.TXN_TYPE = 'REVERSAL' AND TX.ORG_TXN_TYPE='CREDIT')  THEN 'CREDITREVERSAL' ELSE TX.TXN_TYPE END TXN_TYPE,
TX.TXN_NOTE NARRATION,
to_char(TX.START_DATETIME,'DD/MM/YYYY HH:MM:SS AM') START_DATETIME,
TX.AMOUNT_PAISA AMOUNT_PAISA,
TX.PAYER_MOBILE_NO PAYER_MOBILE_NO,
TX.PAYER_NAME PAYER_NAME,
TX.PAYER_ADDRS PAYER_ADDRS,
TX.PAYER_ACCOUNT_NO PAYER_ACCOUNT_REF_NO,
TX.PAYER_IFSC PAYER_IFSC,
TX.PAYER_MCC_CODE PAYER_MCC_CODE,
TX.PAYEE_MOBILE_NO PAYEE_MOBILE_NO,
TX.PAYEE_NAME PAYEE_NAME,
TX.PAYEE_ADDRS PAYEE_ADDRS,
TX.PAYEE_ACCOUNT_NO PAYEE_ACCOUNT_REF_NO,
TX.PAYEE_IFSC PAYEE_IFSC,
TX.PAYEE_MCC_CODE PAYEE_MCC_CODE,
TX.TXN_CODE SWITCH_STATUS,
CASE WHEN TX.TXN_CODE='00' THEN 'C' WHEN TX.TXN_CODE='UKN' OR TX.TXN_CODE='96' THEN 'I' ELSE 'F' END STATUS,
CASE WHEN TX.CBS_RESP_CODE IS NULL OR TX.CBS_RESP_CODE='' THEN TX.TXN_CODE ELSE TX.CBS_RESP_CODE END CBS_RESP_CODE,
CASE WHEN TX.RECORD_TYPE  IS NULL OR TX.RECORD_TYPE='' THEN  'P2M' ELSE TX.RECORD_TYPE END RECORD_TYPE,
CASE WHEN TX.BENE_DETAILS  IS NULL OR TX.BENE_DETAILS='' THEN  'P2A' ELSE TX.BENE_DETAILS END BENE_DETAILS,
TX.CUR CURRENCY,
TX.TXN_PURPOSE TXN_PURPOSE,
TX.INITIATION_MODE INITIATION_MODE,
TX.CBS_EXT_REF_NO CBS_EXT_REF_NO
from UPI_CL_TXN_DETAILS TX where TX.START_DATETIME BETWEEN '03-12-24' AND '04-12-24';
